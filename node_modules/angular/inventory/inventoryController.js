angular.module('inventoryApp', []).controller('inventoryCtrl', function($scope, $http) {
    
	var url = "http://localhost:3000/api/inventoryapi/:";
	
	$scope.change = function(){
		fetch();
	};
	
	$scope.add = function() {
		if($scope.addToCollection == null ) {
			$scope.warning = "Please fill out all fields.";
		}
		else if($scope.addName == null){
			$scope.warning = "Please fill out all fields.";
		}
		else if($scope.addType == null){
			$scope.warning = "Please fill out all fields.";
		}
		else if($scope.addCost == null){
			$scope.warning = "Please fill out all fields.";
		}
		else {
			$http.post("http://localhost:3000/api/inventoryapi?collection=" + $scope.addToCollection + "&name=" + $scope.addName + "&type=" + $scope.addType + "&cost=" + $scope.addCost)
					.success(function(response){
						$scope.warning = response;
					});
		}
	};
	
	$scope.radioGroupChange = function() {
		$scope.collection = $scope.radioGroup.value;
		fetch();
	};
	
	$scope.radioByChange = function() {
		$scope.searchBy = $scope.radioBy.value;
		fetch();
	};
	
	$scope.radioAddChange = function() {
		$scope.addToCollection = $scope.radioAdd.value;
		$scope.warning = $scope.addToCollection;
	};
	
	function fetch() {
		if($scope.collection == null) {
			$scope.collection = "boat";
		}
		else {
			if($scope.searchBy == null) {
				//Defaults to name
				$http.get("http://localhost:3000/api/inventoryapi?collection=" + $scope.collection + "&searchby=name&search=" + $scope.searchField)
					.success(function(response){
						$scope.details = response;
					});
			}
			else {
				//Otherwise parameterize the search
				$http.get("http://localhost:3000/api/inventoryapi?collection=" + $scope.collection + "&searchby=" + $scope.searchBy + "&search=" + $scope.searchField)
					.success(function(response){
						$scope.details = response;
					});
			}
		}
	}

});